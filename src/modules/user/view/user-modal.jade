div.container.user-modal
  div.header.mt-2.mb-0
    div.logo
      img.logo(src="images/isologo-premium-modal.png")
    div.close
      i.material-icons(ng-click="close()") close

  div.title.mb-3 
    h3 Perfilamiento de Usuario

  div.indicator-container
    div.row.step-strip
      div.strip.col-lg-offset-4-5.col-lg-1.col-md-offset-4-5.col-md-1.col-sm-offset-3.col-sm-2.col-xs-offset-1-5.col-xs-3(ng-class="{'pending': stepData[0].completed}")
      div.strip.col-lg-1.col-md-1.col-sm-2.col-xs-3(ng-class="{'pending': stepData[1].completed}")
      div.strip.col-lg-1.col-md-1.col-sm-2.col-xs-3(ng-class="{'pending': stepData[2].completed}")

    div.row.step-indicators
      div.col-lg-offset-4.col-lg-1.col-md-offset-4.col-md-1.col-sm-offset-2.col-sm-2.col-xs-3.indicator.pending
        span.icon(ng-if="!stepData[0].completed") 1
        span.icon(ng-if="stepData[0].completed")
          i.material-icons check  
        span.sub-title Usuario

      div.col-lg-1.col-md-1.col-sm-2.col-xs-3.indicator(ng-class="{'pending': stepData[0].completed}")
        span.icon(ng-if="!stepData[1].completed") 2
        span.icon(ng-if="stepData[1].completed")
          i.material-icons check
        span.sub-title Funciones

      div.col-lg-1.col-md-1.col-sm-2.col-xs-3.indicator(ng-class="{'pending': stepData[1].completed}")
        span.icon(ng-if="!stepData[2].completed") 3
        span.icon(ng-if="stepData[2].completed")
          i.material-icons check
        span.sub-title Reglas

      div.col-lg-1.col-md-1.col-sm-2.col-xs-3.indicator(ng-class="{'pending': stepData[2].completed}")
        span.icon(ng-if="!stepData[3].completed") 4
        span.icon(ng-if="stepData[3].completed")
          i.material-icons check
        span.sub-title Confirmación

  div.row.mb-6
    div.col-lg-12
      wizard(on-finish="finishedWizard()" hide-indicators="true")
        wz-step(canexit="exitValidation")
          h4.text-center.mb-2 Seleccione el Tipo de usuario ( solicitud Nº {{userRequest}} )
          
          form.row(name="form")
            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.detail-account
              div.account-container
                label.mb-0 Estimado cliente
                p.mb-0 La siguiente solicitud posee un tiempo de Aprobación de 48 horas habiles, desde la entrega del documento a las dependencias del Banco Consorcio.

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r
              div.placeholder-select
                label Usuario
              md-input-container.input-form
                md-select.md-no-underline(ng-model="stepData[0].data.userType" ng-model-options="{trackBy: '$value.id'}") 
                  md-option.text-uppercase(ng-value="type" ng-repeat="type in userTypes") {{type.name}}

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.mb-3(ng-if="stepData[0].data.userType.id == 1")
              div.placeholder-select
                label Tipo de Apoderado
              md-input-container.input-form
                md-select.md-no-underline(ng-model="stepData[0].data.userTypeSelected" ng-model-options="{trackBy: '$value.name'}") 
                  md-option.text-uppercase(ng-value="account" ng-repeat="account in userTypeSelected") {{account.name}}

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.mb-3(ng-if="stepData[0].data.userType.id == 2")
              div.placeholder-select
                label Tipo de Operador
              md-input-container.input-form
                md-select.md-no-underline(ng-model="stepData[0].data.userTypeSelected" ng-model-options="{trackBy: '$value.name'}") 
                  md-option.text-uppercase(ng-value="account" ng-repeat="account in userTypeSelected") {{account.name}}

            div.col-lg-offset-3.col-lg-4.col-md-offset-3.col-md-4.col-sm-offset-1.col-sm-6.col-xs-12.center-xs
              span.radio-text Copiar Funciones de otro Usuario {{userTypeText}}
            div.col-lg-2.col-md-2.col-sm-4.col-xs-12.destinatario
              md-radio-group(ng-model="stepData[0].data.copyFunction")
                md-radio-button.md-primary(value="SI") Si
                md-radio-button.md-primary(value="NO") No

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.padding-0.abono-pago-type
              div.col-lg-12.col-md-12.col-sm-12.col-xs-12.p-0
                  div.col-xs-12.user-add
                    span.text Usuarios Ingresados
                    span.count {{userList.length}} usuario(s)

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.pl-0.padding-rigth-xs-0
                div.input-form
                  div.form-text
                      label.rut Rut
                  div.form-element
                      input(name="rut" type="text" autocomplete="off" ng-model="stepData[0].data.rut" mask="99.999.999-9" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.p-0
                div.input-form
                  div.form-text
                      label.rut Forma de Abono
                  div.form-element
                      input(name="name" type="text" autocomplete="off" ng-model="stepData[0].data.forma" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.pl-0.padding-rigth-xs-0
                div.input-form
                  div.form-text
                      label.rut Apellido Paterno
                  div.form-element
                      input(name="firstName" type="text" autocomplete="off" ng-model="stepData[0].data.firstName" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.p-0
                div.input-form
                  div.form-text
                      label.rut Apellido Materno
                  div.form-element
                      input(name="lastName" type="text" autocomplete="off" ng-model="stepData[0].data.lastName" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.pl-0.padding-rigth-xs-0
                div.input-form
                  div.form-text
                      label.rut Fecha de Nac.
                  div.form-element
                      input(name="nac" type="text" autocomplete="off" ng-model="stepData[0].data.nac" mask="99 / 99 / 9999" placeholder="_ / _ / _")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.p-0
                div.input-form
                  div.form-text
                      label.rut Email
                  div.form-element
                      input(name="email" type="text" autocomplete="off" ng-model="stepData[0].data.email" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.pl-0.padding-rigth-xs-0
                div.input-form
                  div.form-text
                      label.rut Teléfono
                  div.form-element
                      input(name="phone" type="text" autocomplete="off" ng-model="stepData[0].data.phone" placeholder="Ingresar")

              div.col-lg-6.col-md-6.col-sm-6.col-xs-12.p-0
                div.placeholder-select
                  label Sexo
                md-input-container.input-form
                  md-select.md-no-underline(ng-model="stepData[0].data.gender" ng-model-options="{trackBy: '$value.name'}") 
                    md-option.text-uppercase(ng-value="gender" ng-repeat="gender in genders") {{gender.name}}

              div.col-lg-offset-1.col-lg-10.col-md-offset-1.col-md-10.col-sm-offset-1.col-sm-10.col-xs-12.pt-2
                button.button-default.col-lg-offset-1.col-lg-5.col-md-offset-1.col-md-5.col-sm-offset-2.col-sm-4.col-xs-6(ng-click="close()") CANCELAR
                input.button-success.col-lg-5.col-md-5.col-sm-4.col-xs-6(type="submit" ng-click="setLoadingStep()" value="Siguiente" ng-if="!saving")
                button.button-success.spinner-custom.col-lg-5.col-md-5.col-sm-4.col-xs-6(ng-if="saving")
                  img(src="images/spinner.gif")

        wz-step(canexit="exitValidation")
          h4.text-center.mb-2 Asignación de Funcionalidades Cuenta Corriente

          form.row(name="form")

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.padding-0.abono-pago-type
              div.col-lg-12.col-md-12.col-sm-12.col-xs-12.p-0
                div.col-xs-12.user-add
                  span.text Usuarios Ingresados
                  span.count {{userList.length}} usuario(s)

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.mb-1
              div.col-lg-4.col-md-6.col-sm-12.col-xs-6.pt-025
                label.text Todas las Cuentas
              div.col-lg-2.col-md-6.col-sm-12.col-xs-6.pl-0
                md-switch.md-primary(ng-model="stepData[1].data.checkAllAccount", ng-change="checkAll(stepData[1].data.accountStorage, 'checkAllAccount')")

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.account-check
              div.col-lg-6.col-md-6.col-sm-6.col-xs-6(ng-repeat="account in stepData[1].data.accountStorage")
                md-checkbox.md-primary(ng-change="check(stepData[1].data.accountStorage, 'checkAllAccount')" ng-model="account.selected") {{account.account}}


            div.col-lg-offset-3.col-lg-3.col-md-offset-3.col-md-3.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.mb-1.mt-1
              
              div.col-lg-8.col-md-6.col-sm-12.col-xs-6.pt-025.mb-1
                label.text Todas los Modulos
              div.col-lg-3.col-md-6.col-sm-12.col-xs-6.pl-0.mb-1
                md-switch.md-primary(ng-model="stepData[1].data.checkAllModule", ng-change="checkAll(stepData[1].data.moduleStorage, 'checkAllModule')")

              div.col-lg-12.col-md-12.col-sm-12.col-xs-12.account-check(ng-repeat="module in stepData[1].data.moduleStorage")
                md-checkbox.md-primary(ng-change="check(stepData[1].data.moduleStorage, 'checkAllModule')" ng-model="module.selected") {{module.name}}

            
            div.col-lg-3.col-md-3.col-sm-3.col-xs-12.padding-0.pos-r.mb-1.mt-1
              
              div.col-lg-9.col-md-6.col-sm-12.col-xs-6.pt-025.mb-1
                label.text Modulo Transferencias
              div.col-lg-3.col-md-6.col-sm-12.col-xs-6.pl-0.mb-1
                md-switch.md-primary(ng-model="stepData[1].data.checkAllTransferModule", ng-change="checkAll(stepData[1].data.moduleTransferStorage, 'checkAllTransferModule')")

              div.col-lg-12.col-md-12.col-sm-12.col-xs-12.account-check(ng-repeat="module in stepData[1].data.moduleTransferStorage")
                md-checkbox.md-primary(ng-change="check(stepData[1].data.moduleTransferStorage, 'checkAllTransferModule')" ng-model="module.selected") {{module.name}}


            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.detail-account
              div.col-lg-offset-1.col-lg-10.col-md-offset-1.col-md-10.col-sm-offset-1.col-sm-10.col-xs-12.pt-2
                button.button-default.col-lg-offset-1.col-lg-5.col-md-offset-1.col-md-5.col-sm-offset-2.col-sm-4.col-xs-6(wz-previous="backStep()") ATRAS
                input.button-success.col-lg-5.col-md-5.col-sm-4.col-xs-6(type="submit" ng-click="setLoadingStep()" value="Siguiente" ng-if="!saving")
                button.button-success.spinner-custom.col-lg-5.col-md-5.col-sm-4.col-xs-6(ng-if="saving")
                  img(src="images/spinner.gif")

        wz-step(canexit="exitValidation")
          h4.text-center.mb-2 Tipo de Apoderado y Reglas

          form.row(name="form")
            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r(ng-if="stepData[0].data.userType.id == 1")
              div.placeholder-select
                label Tipo de Apoderado
              md-input-container.input-form
                md-select.md-no-underline(ng-model="stepData[0].data.userTypeSelected" ng-model-options="{trackBy: '$value.name'}") 
                  md-option.text-uppercase(ng-value="account" ng-repeat="account in userTypeSelected") {{account.name}}

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r(ng-if="stepData[0].data.userType.id == 2")
              div.placeholder-select
                label Tipo de Operador
              md-input-container.input-form
                md-select.md-no-underline(ng-model="stepData[0].data.userTypeSelected" ng-model-options="{trackBy: '$value.name'}") 
                  md-option.text-uppercase(ng-value="account" ng-repeat="account in userTypeSelected") {{account.name}}

            div.col-lg-offset-3.col-lg-6.col-md-offset-3.col-md-6.col-sm-offset-1.col-sm-10.col-xs-12.padding-0.pos-r.mb-1
              div.col-lg-5.col-md-6.col-sm-12.col-xs-6.pt-025
                label.text Asignar todas las Reglas
              div.col-lg-2.col-md-6.col-sm-12.col-xs-6.pl-0
                md-switch.md-primary(ng-model="stepData[2].data.checkAllRule", ng-change="checkAll(stepData[2].data.ruleStorage, 'checkAllRule')")